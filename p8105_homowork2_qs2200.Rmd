---
title: "p8105_homework2_qs2200"
author: "Qi Shao"
date: "10/2/2018"
output: github_document
---

```{r setup, include=FALSE}
library(tidyverse)
```

# Problem 1
```{r problem 1.1, message = FALSE}
transit_data = 
  read_csv(file = "./data/NYC_Transit_Subway_Entrance_And_Exit_Data.csv") %>%
  janitor::clean_names() %>%
  select(line, station_name, station_latitude, station_longitude, route1:route11, entry, vending, entrance_type, ada) %>%
  mutate(entry = recode(entry, `YES` = "TRUE", `NO` = "FALSE")) %>%
  mutate(entry = as.logical(entry))
```

**1. Describe the dataset.**

This dataset `transit_data` contains `r ncol(transit_data)` variables, they are `r names(transit_data)`.
At first I import the dataset, and clean it's name using the function`janitor::clean_names`, and select required columns, change the variable type of the entry variable.

The result dataset is `r nrow(transit_data)` rows by `r ncol(transit_data)`columns.

These data are still untidy, the route number and route name variables are not clear for people to read.

**2. Answer questions using the dataset.**

```{r problem 1.2}
dist_transit_data = 
  distinct(transit_data, station_name, line, .keep_all = TRUE)

```
* How many distinct stations are there?

There are `r nrow(dist_transit_data)` distinct stations in the dataset.

* How many stations are ADA compliant?

`r sum(dist_transit_data$ada == TRUE)` stations are ADA compliant.

* What proportion of station entrances / exits without vending allow entrance?

`r sum(transit_data$vending == "NO")/length(transit_data$vending) * 100` percent of station entrances / exits do not have vending allow entrance.

**3. Reformat data.**
```{r problem 1.3}
reformat_transit_data = transit_data %>%
  gather(key = route_number, value = route_name, route1:route11)

dis_refo_data = reformat_transit_data %>%
  distinct(transit_data, station_name, line, .keep_all = TRUE)
```

* How many distinct stations serve the A train? 

There are `r sum(dis_refo_data$route_name == "A")` distinct stations serve the A train.

* Of the stations that serve the A train, how many are ADA compliant?

Of all stations that serve the A train, `r sum(dis_refo_data$route_name == "A" & dis_refo_data$ada == TRUE)` stations are ADA compliant.

# Problem 2

**1. Read and clean the Mr. Trash Wheel sheet.**
```{r problem 2.1}
library(cellranger)
mr_trash_wheel = 
  readxl::read_excel("./data/HealthyHarborWaterWheelTotals2017-9-26.xlsx", sheet = 1, range = cell_cols("A:N")) %>%
  janitor::clean_names() %>%
  na.omit(1) %>%
  mutate(sports_balls = as.integer(sports_balls))
```         

**2. Read and clean precipitation data for 2016 and 2017.**
```{r problem 2.2}
precipitation_2016 = 
  readxl::read_excel("./data/HealthyHarborWaterWheelTotals2017-9-26.xlsx", sheet = 4,  range = "A2:B14") %>%
  janitor::clean_names() %>%
  na.omit(2) %>%
  mutate(year = "2016")

precipitation_2017 = 
  readxl::read_excel("./data/HealthyHarborWaterWheelTotals2017-9-26.xlsx", sheet = 3, range = "A2:B14") %>%
  janitor::clean_names() %>%
  na.omit(2) %>%
  mutate(year = "2017")

precip_data = 
  bind_rows(precipitation_2016, precipitation_2017) %>%
  mutate(month = (month.name[month])) %>%
  select(year, everything())

```
